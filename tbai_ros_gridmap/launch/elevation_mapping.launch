<?xml version="1.0" encoding="utf-8"?>
<launch>

  <!-- Launch convex decomposition node -->
  <include file="$(find convex_plane_decomposition_ros)/launch/convex_plane_decomposition.launch">
    <arg name="parameter_file"      default="$(find tbai_ros_gridmap)/config/convex_plane_decomposition_parameters.yaml"/>
    <arg name="node_parameter_file" default="$(find tbai_ros_gridmap)/config/convex_plane_decomposition_node.yaml"/>
  </include>

  <!-- Elevation mapping -->
  <node pkg="nodelet" type="nodelet" name="pcl_manager" args="manager" output="screen"/>
    
  <!-- Front camera -->
  <node pkg="nodelet" type="nodelet" name="voxel_grid" args="load pcl/VoxelGrid pcl_manager" output="screen">
    <remap from="~input" to="/camera/depth/points"/>
    <remap from="~output" to="/camera/depth/points_downsampled"/>
    <rosparam>
        filter_field_name: z
        filter_limit_min: 0.01
        filter_limit_max: 4.0  <!-- Limit the range of points to forward to 6 meters in viewing direction-->
        filter_limit_negative: False
        leaf_size: 0.06  <!-- Limit the density to 5 cm-->
    </rosparam>
  </node>

  <node pkg="elevation_mapping" type="elevation_mapping" name="elevation_mapping" output="screen">
    <rosparam command="load" file="$(find tbai_ros_gridmap)/config/elevation_mapping.yaml"/>
    <rosparam command="load" file="$(find tbai_ros_gridmap)/config/post_processing.yaml" />
  </node>

</launch>